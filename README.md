# DZ_ML

1. Был проведен EDA и обработка признаков, в ходе которого:

- были удалены повторяющиеся строки в train
- убраны единицы измерения для признаков mileage, engine, max_power
- удален столбец torque 
- заполнены пропуски в столбцах медианами 

2. В ходе визаулизации были выявлены следующие зависимости: 

- Связь предикторов с целевой переменной
Наблюдается линейная зависимость признаков max_power, engine, year и selling_price
Больше всего машин с кол-вом сидений 5 и они имеют разную ценовую категорию
Чем больше max_power, тем выше стоимость автомобиля
C увеличением мощности двигателя engine, увеличивается стоимость автомобиля
Новые автомобили по признаку year продаются дороже

- Корреляция признаков

Наибольшие значения max_power, engine наблюдаются у новых машин (корреляция с признаком year)
Наименее скоррелированы между собой признаки year и engine (корреляция 0.0028). Также низкая корреляция у признаков year и seats (0.041).
Сильная положительная линейная зависимость наблюдается между признаками selling_price и max_power (корреляция 0.69) и между engine и max_power (корреляция 0.68)

- Дополнительные визуализации позволили сделать следующие выводы: 

С помощью графика было определено распределение количества продающихся машин по годам: больше всего машин, выставленных на продажу, находятся в диапазоне 2011 - 2018 года
Тип топлива влияет на цену автомобиля, больше всего машин с типом Diesel и Petrol.
Тип трансмиссии влияет на цену: автоматическая стоит дороже
Чем больше у автомобиля было владельцев, тем дешевле он стоит на рынке. Средняя стоимость машины с test drive выше, чем стоимость машины с одним владьцем. Данную иерархию можно применить в label encoding.

3. Были применены модели (только на вещественных признаках):
 - Linear Regression c результатом  r2_score 0.5941419786868934, MSE 233298780185.69 (лучший результат среди трех представленных)
 - Lasso регрессия c результатом r2_score 0.594140811610729 и MSE 233299451054.39594
 - ElasticNet регрессия с результатом r2_score 0.5615212672750486 и MSE 252050096610.45932
 
 Лучший результат показала модель гребневой регрессии с параметрами Ridge(alpha=7.0): 
 r2_score составил 0.6406429664774221
 MSE 206568684538.29947
 
 4. Были произведены дополнительные преобразования: 
 - Добавлена колонка с брендом машины 
 - Изменена колонка с именем машины (сокращена до словосочетания из двух слов)
 - Логарифмирован признак km_driven 
 - Преобразовано кол-во владельцев с помощью label encoding: первый владелец имеет наибольший вес, машина с 4 и более владельцами - наименьший
 - Применен Label Encoding к столбцам transmission и fuel (исходя из доп графиков визуализации)
 - Применен LeaveOneOutEncoder к столбцам ['seats','seller_type','brand','name_changed']
 - Использован MinMaxScaler 
 
 В результате с помощью GridSearchCV найдены лучшие параметры модели: (Ridge(alpha=4.5))
 r2_score составил 0.7849099693722473
 MSE 123639891637.97984
 
 5. Посчитана бизнес-метрика: доля предиктов, отличающихся от реальных цен на авто не более чем на 10% (в одну или другую сторону)
 Метрика составила 75,5% 
 

